@{
    Layout = null;
    //Truy cập ...localhost:XXXX/Student/Dashboard
}
@model WebNangCao_MVC_Model.ViewModels.StudentDashboardViewModel
<!DOCTYPE html>
    <html>
    <head>
        <title>Dashboard Thí Sinh</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="~/css/student-dashboard.css" />
        <script src="https://unpkg.com/lucide@latest"></script>
    </head>
    <body class="dashboard-body">
    
        <header class="top-header">
        <a asp-controller="Home" asp-action="Index" class="btn-back">
                <i data-lucide="arrow-left" class="back-icon"></i>
            Quay lại
            </a>
            <div class="user-info">
                <span class="greeting">Xin chào, </span>
                <!--sử dụng tên là tên Username-->
                @if (User.Identity!=null &&User.Identity.IsAuthenticated)
                {
                <span class="user-name">@User.Identity.Name</span>
                }
                
                <!--Sử avater là avatar của username--></>
                <div class="avatar-container">
                    <div class="avatar" id="userAvatar">N</div>

                    <div class="avatar-dropdown" id="avatarDropdown">
                        <div class="dropdown-header">
                            <strong>Nguyễn Văn A</strong>
                            <span>student@example.com</span>
                        </div>
                        <ul class="dropdown-list">
                            <li><a href="#"><i data-lucide="user"></i> Hồ sơ cá nhân</a></li>
                            <li><a href="#"><i data-lucide="settings"></i> Cài đặt</a></li>
                            <li class="divider"></li>
                        <li>
                            <a href="/Account/Logout" 
                               onclick="return confirm('Bạn có chắc chắn muốn đăng xuất?');" 
                               class="text-danger">
                                <i data-lucide="log-out"></i> Đăng xuất
                            </a>
                        </li>
                        </ul>
                    </div>
                </div>
            </div>
        </header>
        <main class="dashboard-container">
            
            <section class="page-title">
            <h1>Dashboard Thí Sinh</h1>
            <p>Tìm kiếm và tham gia các bài thi</p>
            </section>

            <section class="stats-grid">
                <div class="stat-card">
                    <div class="stat_info">
                        <span class="stat-label">Tổng bài thi</span>
                        <span class="stat-value">@Model.TotalExams</span>
                    </div>
                    <div class="stat-icon bg-blue"><i data-lucide="file-text"></i></div>
                </div>
                <div class="stat-card">
                    <div class="stat-info">
                        <span class="stat-label">Điểm trung bình</span>
                        <span class="stat-value">@Model.AverageScore</span>
                    </div>
                <div class="stat-icon bg-green"><i data-lucide="trophy"></i></div>
                </div>
                <div class="stat-card">
                    <div class="stat-info">
                        <span class="stat-label">Hoàn thành</span>
                        <span class="stat-value">@Model.CompletedExams/@Model.TotalExams</span>
                    </div>
                    <div class="stat-icon bg-purple"><i data-lucide="check-circle"></i></div>
                </div>
                <div class="stat-card">
                    <div class="stat-info">
                        <span class="stat-label">Sắp tới</span>
                        <span class="stat-value">@Model.UpcomingExams</span>
                    </div>
                    <div class="stat-icon bg-orange"><i data-lucide="clock"></i></div>
                </div>
            </section>

            <section class="exam-section">
                <div class="exam-header">
                    <h2><i data-lucide="list"></i> Danh sách các bài thi</h2>
                    <p>Tìm thấy 8 bài thi</p>
                </div>

                <div class="search-filter-bar">
                    <div class="search-box">
                        <i data-lucide="search"></i>
                    <input type="text" placeholder="Tìm kiếm bài thi theo tên hoặc môn học..." />
                    </div>
                    <button class="btn-toggle-filter" id="btnToggleFilter">
                        <i data-lucide="filter"></i> Bộ lọc
                    </button>
                </div>
                <div class="advanced-filter" id="advancedFilter">
                    <div class="filter-group">
                        <label></label>
                        <select><option>Tất cả môn học</option></select>
                    </div>
                    <div class="filter-group">
                        <label>Trạng thái</label>
                        <select><option>Tất cả trạng thái</option></select>
                    </div>
                    <div class="filter-group">
                        <label>Độ khó</label>
                        <select><option>Tất cả độ khó</option></select>
                    </div>
                </div>
                
                <div class="status-tabs">
                    <button class="tab-btn active">Tất cả (8)</button>
                    <button class="tab-btn">Có thể làm (4)</button>
                    <button class="tab-btn">Sắp tới (3)</button>
                    <button class="tab-btn">Đã hoàn thành (1)</button>
                </div>

            <div class="exam-grid">
                @if (Model.Exams != null && Model.Exams.Count > 0)
                {
                    @foreach (var exam in Model.Exams)
                    {
                        <div class="exam-card">
                            <div class="card-header">
                                <h3>@exam.Title</h3>
                                @if (exam.Status == "Có thể làm")
                                {
                                    <span class="badge badge-success">Có thể làm</span>
                                }
                                else if (exam.Status == "Sắp tới")
                                {
                                    <span class="badge badge-blue">Sắp tới</span>
                                }
                                else
                                {
                                    <span class="badge badge-gray">Đã hoàn thành</span>
                                }
                            </div>
                            <div class="card-tags">
                                <span class="tag tag-blue">@exam.SubjectName</span>
                                <span class="tag tag-orange">@exam.Difficulty</span>
                            </div>
                            <div class="card-details">
                                <div class="detail-item"><i data-lucide="calendar"></i> @exam.StartTime.ToString("dd/MM/yyyy HH:mm")</div>
                                <div class="detail-item"><i data-lucide="clock"></i> @exam.Duration phút</div>
                                <div class="detail-item"><i data-lucide="file-text"></i> @exam.TotalQuestions câu hỏi</div>
                                <div class="detail-item"><i data-lucide="users"></i> @exam.GroupName (Mã lớp: @exam.IdGroup)</div>
                            </div>

                            @if (exam.Status == "Có thể làm")
                            {
                                <a asp-controller="TestAttempt"
                                   asp-action="GiaoDienLamBai"
                                   asp-route-id="@exam.Id"
                                   class="btn-primary-action" style="text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 8px;">
                                    <i data-lucide="play-circle"></i> Bắt đầu làm bài
                                </a>
                            }
                            else if (exam.Status == "Sắp tới")
                            {
                                <button class="btn-disabled" disabled><i data-lucide="history"></i> Chưa tới giờ thi</button>
                            }
                            else
                            {
                                <button class="btn-disabled" disabled style="background-color: #e2e8f0; color: #475569;"><i data-lucide="check-circle"></i> Đã hoàn thành</button>
                            }
                        </div>
                    }
                }
                else
                {
                    <div class="empty-state" style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #64748b;">
                        <i data-lucide="inbox" style="width: 48px; height: 48px; margin-bottom: 16px; opacity: 0.5;"></i>
                        <h3>Không có bài thi nào</h3>
                        <p>Bạn chưa có bài thi nào từ các lớp đã tham gia.</p>
                    </div>
                }
            </div>
            </section>
        </main>
        <script src="~/js/student-dashboard.js"></script>
    </body>
    </html>